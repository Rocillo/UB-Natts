
{% extends "base.html" %}

{% block content %}


<div class="container-fluid text-white p-0">
    <div class="p-5 text-center bg-image">
        <div class="row d-flex justify-content-center">
            <div class="col-5 col-lg-3 px-0 py-0">
                <div class="card o-hidden h-100 bg-light align-items-center" style="border: #2e1272,solid,3px;">
                    <div class="card-body">
                        <form class="text-center" id="logprimaryrm">
                            <i class="px-2 m-0"><img src="{{ url_for('static', filename='senai-1.0.0/images/ubnatts.png') }}" ></i>
                            <input type="text" class="form-control my-2" id="user" placeholder="Usuário" required>
                            <div class="input-group flex-nowrap d-flex justify-content-center align-items-center">
                                <input type="password" class="form-control my-2" id="password" placeholder="Senha"required>
                                <button type="button" class="btn btn-dark my-2" onclick="togglePasswordVisibility()" style=" background-color: #080664">
                                    <i class="fa fa-eye" id="eye-icon" style="font-size: 20px;"></i>
                                </button>
                            </div>                                
                            <button type="submit" class="btn my-2 w-100 border border-dark text-white" style="background-color: #080664;border: #000,solid,5px;">Entrar</button>
                        </form>                     
                    </div>   
                </div>
        </div>
    </div>
</div>

<script>

    /*Login request*/
    jQuery('#logprimaryrm').on('submit', function(e){
        e.preventDefault();
        jQuery.ajax({
            url: '/login',
            type: 'POST',
            data: {'user': jQuery('#user').val(), 'password': jQuery('#password').val()}, 
            success: function(response){
                if(response['Login']){
                    jQuery('#message').modal('show');
                    jQuery('#messageText').text('Login efetuado com sucesso');
                    setTimeout(function(){jQuery('#message').modal('hide')}, 1500);
                    location.reload();  
                }
                else{
                    jQuery('#message').modal('show');
                    jQuery('#messageText').text('Usuário e/ou senha incorretos');
                    setTimeout(function(){jQuery('#message').modal('hide')}, 1500);  

                }
                
            }
        });
    });

    function togglePasswordVisibility() {
      var passwordInput = document.getElementById("password");
      var eyeIcon = document.getElementById("eye-icon");
      
      if (passwordInput.type === "password") {
        passwordInput.type = "text";
        eyeIcon.classList.remove("fa-eye");
        eyeIcon.classList.add("fa-eye-slash");
      } else {
        passwordInput.type = "password";
        eyeIcon.classList.remove("fa-eye-slash");
        eyeIcon.classList.add("fa-eye");
      }
    }

</script>

{% endblock %}